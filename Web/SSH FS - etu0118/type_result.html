<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CARGOOO! – Type Navire</title>

  <!-- Police + feuille globale -->
  <link href="https://fonts.googleapis.com/css2?family=Belanosima:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" />

  <!-- Modules utilitaires communs -->
  <script type="module" src="../js/utils.js"></script>
  <script type="module" src="../js/api.js"></script>
</head>
<body>
    
  <!-- ═════ NAVBAR partagée ═════ -->
  <nav class="navbar">
    <a href="index.html"><img src="../assets/LOGO__CARGOOO.png" alt="Logo" class="logo" /></a>
    <ul class="nav-links">
      <li><a href="index.html">Accueil</a></li>
      <li><a href="visualisation.html">Visualisation</a></li>
      <li><a href="ajout.html">Ajout Données</a></li>
      <li><a href="prediction.html">Prédiction</a></li>
    </ul>
  </nav>

  <main id="type-page">
    <h2>Prédiction du type de navire</h2>

    <div class="form-container text-center" id="type-card" style="background:linear-gradient(135deg,#ffffff 0%,#e6f0ff 100%);border-radius:12px;padding:24px;box-shadow:0 6px 18px rgba(0,0,0,.12);">
      <h3 class="mb-3">Type prédit :</h3>
      <p id="typeOut" class="fs-3 fw-bold">⏳</p>

      <div class="mt-4">
        <a href="prediction.html" class="btn btn-outline-primary">&larr; Retour</a>
      </div>
    </div>
  </main>

  <!-- ═════ JS spécifique à la page ═════ -->
  <script type="module">
    import { showAlert } from '../js/utils.js';
    import { postJSON }  from '../js/api.js';

    /* 1. Récupérer le MMSI de l'URL */
    const mmsi = new URLSearchParams(location.search).get('mmsi');
    const out  = document.getElementById('typeOut');

    if (!mmsi) {
      showAlert('MMSI manquant', 'error');
      out.textContent = '–';
      throw new Error('No MMSI');
    }

    /* 2. Appel backend + affichage */
    (async function init() {
      try {
        const resp = await postJSON('php/predict_type.php', { mmsi });
        const obj  = resp.data ?? resp;   // compat enveloppe
        out.textContent = obj.type ?? obj;
      } catch (err) {
        showAlert(err.message, 'error');
        out.textContent = 'Erreur';
      }
    })();
  </script>
</body>
</html>
